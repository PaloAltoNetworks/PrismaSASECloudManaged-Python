# Examples on how to work with Vulnerability Protect Signatures
In all examples, it will either return a success or failure when attempting the operation.

## Authentication
First authenticate to the API service:
```python
from auth import saseAuthentication
from access import prismaAccess
from access import securityServices

p = saseAuthentication.saseAuthentication()
p.prismaAccessAuthLoadToken()
n = prismaAccess.prismaAccess(p.saseToken)
```

Now we can proceed with the commands below.

## List all Vulnerability Protect Signatures
To list all Vulnerability Protect Signatures within shared folder (it defaults to _Shared_ folder)
```python
s = securityServices.securityServices(n)

s.paVulnerabilityProtectSignatureList()
```


To list all Vulnerability Protect Signatures within a specific folder, e.g. _Shared_ (it defaults to _Shared_).
```python
s = securityServices.securityServices(n)

s.paVulnerabilityProtectSignatureList("Shared")
```


## Create a Vulnerability Protect Signatures
To create a Vulnerability Protect Signatures in the _Shared_ folder (it defaults to _Shared_).

```python
s = securityServices.securityServices(n)

vulnerabilityProtectSignature = {"folder":"Shared","default_action":{"alert":{}},"direction":"both","severity":"informational","affected_host":{"client":True},"cve":["CVE-12222"],"threatname":"Example","signature":{"standard":[{"name":"ExampleSig","scope":"protocol-data-unit","and_condition":[{"name":"And Condition 1","or_condition":[{"name":"Or Condition 1","operator":{"less_than":{"context":"cip-ethernet-ip-req-instance-id","value":0}}}]}]}]},"threat_id":"41012"}
s.paVulnerabilityProtectSignatureCreate(vulnerabilityProtectSignature)
```

This will create a Vulnerability Protect Signature in the "Shared" folder.

```python
s = securityServices.securityServices(n)

vulnerabilityProtectSignature = {"folder":"Shared","default_action":{"alert":{}},"direction":"both","severity":"informational","affected_host":{"client":True},"cve":["CVE-12222"],"threatname":"Example","signature":{"standard":[{"name":"ExampleSig","scope":"protocol-data-unit","and_condition":[{"name":"And Condition 1","or_condition":[{"name":"Or Condition 1","operator":{"less_than":{"context":"cip-ethernet-ip-req-instance-id","value":0}}}]}]}]},"threat_id":"41012"}
s.paVulnerabilityProtectSignatureCreate(vulnerabilityProtectSignature, "Remote Networks")
```

## Edit a Vulnerability Protect Signature
It defaults to _Shared_, so if you want it removed there, just remove the _"Remote Networks"_ argument

To edit an existing Vulnerability Protect Signature in the _Remote Networks_ folder. 

This will edit an existing Vulnerability Protect Signature named _Sample Policy_.

```python
s = securityServices.securityServices(n)

vulnerabilityProtectSignature = {"folder":"Shared","default_action":{"alert":{}},"direction":"both","severity":"informational","affected_host":{"client":True},"cve":["CVE-12222"],"threatname":"Example Signature","signature":{"standard":[{"name":"ExampleSig","scope":"protocol-data-unit","and_condition":[{"name":"And Condition 1","or_condition":[{"name":"Or Condition 1","operator":{"less_than":{"context":"cip-ethernet-ip-req-instance-id","value":0}}}]}]}]},"threat_id":"41012"}
s.paVulnerabilityProtectSignatureEdit(vulnerabilityProtectSignature, "Remote Networks")
```

## Delete a Vulnerability Protect Signature
To delete a Vulnerability Protect Signature in the _Remote Networks_ folder. 

It defaults to _Shared_, so if you want it removed there, just remove the _"Remote Networks"_ argument

```python
s = securityServices.securityServices(n)

vulnerabilityProtectSignature = { "threatname": "Example Signature" }
s.paVulnerabilityProtectSignatureDelete(vulnerabilityProtectSignature, "Remote Networks")
```