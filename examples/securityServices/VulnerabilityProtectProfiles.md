# Examples on how to work with Vulnerability Protect Profiles
In all examples, it will either return a success or failure when attempting the operation.

## Authentication
First authenticate to the API service:
```python
from auth import saseAuthentication
from access import prismaAccess
from access import securityServices

p = saseAuthentication.saseAuthentication()
p.prismaAccessAuthLoadToken()
n = prismaAccess.prismaAccess(p.saseToken)
```

Now we can proceed with the commands below.

## List all Vulnerability Protect Profiles
To list all Vulnerability Protect Profiles within shared folder (it defaults to _Shared_ folder)
```python
s = securityServices.securityServices(n)

s.paVulnerabilityProtectProfilesList()
```


To list all Vulnerability Protect Profiles within a specific folder, e.g. _Shared_ (it defaults to _Shared_).
```python
s = securityServices.securityServices(n)

s.paVulnerabilityProtectProfilesList("Shared")
```


## Create a Vulnerability Protect Profile
To create a Vulnerability Protect Profile in the _Remote Networks_ folder (it defaults to _Shared_).

```python
s = securityServices.securityServices(n)

vulnerabilityProtectProfiles = {"name":"best-practice2","folder":"Shared","description":"Best practice vulnerability protection security profile","rules":[{"name":"simple-client-critical","action":{"reset_both":{}},"vendor_id":["any"],"severity":["critical"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-high","action":{"reset_both":{}},"vendor_id":["any"],"severity":["high"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-medium","action":{"reset_both":{}},"vendor_id":["any"],"severity":["medium"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-informational","vendor_id":["any"],"severity":["informational"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-low","vendor_id":["any"],"severity":["low"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-server-critical","action":{"reset_both":{}},"vendor_id":["any"],"severity":["critical"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-high","action":{"reset_both":{}},"vendor_id":["any"],"severity":["high"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-medium","action":{"reset_both":{}},"vendor_id":["any"],"severity":["medium"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-informational","vendor_id":["any"],"severity":["informational"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"disable"},{"name":"simple-server-low","vendor_id":["any"],"severity":["low"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"}]}
s.paVulnerabilityProtectProfilesCreate(vulnerabilityProtectProfiles)
```

This will create a Vulnerability Protect Profile in the _"Remote Networks"_ folder.

```python
s = securityServices.securityServices(n)

vulnerabilityProtectProfiles = {"name":"best-practice2","folder":"Shared","description":"Best practice vulnerability protection security profile","rules":[{"name":"simple-client-critical","action":{"reset_both":{}},"vendor_id":["any"],"severity":["critical"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-high","action":{"reset_both":{}},"vendor_id":["any"],"severity":["high"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-medium","action":{"reset_both":{}},"vendor_id":["any"],"severity":["medium"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-informational","vendor_id":["any"],"severity":["informational"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-low","vendor_id":["any"],"severity":["low"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-server-critical","action":{"reset_both":{}},"vendor_id":["any"],"severity":["critical"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-high","action":{"reset_both":{}},"vendor_id":["any"],"severity":["high"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-medium","action":{"reset_both":{}},"vendor_id":["any"],"severity":["medium"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-informational","vendor_id":["any"],"severity":["informational"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"disable"},{"name":"simple-server-low","vendor_id":["any"],"severity":["low"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"}]}
s.paVulnerabilityProtectProfilesCreate(vulnerabilityProtectProfiles, "Remote Networks")
```

## Edit a Vulnerability Protect Profile
It defaults to _Shared_, so if you want it removed there, just remove the _"Remote Networks"_ argument

To edit an existing Vulnerability Protect Profile in the _Remote Networks_ folder. 

This will edit an existing Vulnerability Protect Profile named _Sample Policy_.

```python
s = securityServices.securityServices(n)

vulnerabilityProtectProfiles = {"name":"best-practice2","folder":"Shared","description":"Best practice vulnerability protection security profile","rules":[{"name":"simple-client-critical","action":{"reset_both":{}},"vendor_id":["any"],"severity":["critical"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-high","action":{"reset_both":{}},"vendor_id":["any"],"severity":["high"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-medium","action":{"reset_both":{}},"vendor_id":["any"],"severity":["medium"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-informational","vendor_id":["any"],"severity":["informational"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-client-low","vendor_id":["any"],"severity":["low"],"cve":["any"],"threat_name":"any","host":"client","category":"any","packet_capture":"single-packet"},{"name":"simple-server-critical","action":{"reset_both":{}},"vendor_id":["any"],"severity":["critical"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-high","action":{"reset_both":{}},"vendor_id":["any"],"severity":["high"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-medium","action":{"reset_both":{}},"vendor_id":["any"],"severity":["medium"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"},{"name":"simple-server-informational","vendor_id":["any"],"severity":["informational"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"disable"},{"name":"simple-server-low","vendor_id":["any"],"severity":["low"],"cve":["any"],"threat_name":"any","host":"server","category":"any","packet_capture":"single-packet"}]}
s.paVulnerabilityProtectProfilesEdit(vulnerabilityProtectProfiles, "Remote Networks")
```

## Delete a Vulnerability Protect Profile
To delete a Vulnerability Protect Profile in the _Remote Networks_ folder. 

It defaults to _Shared_, so if you want it removed there, just remove the _"Remote Networks"_ argument

```python
s = securityServices.securityServices(n)

vulnerabilityProtectProfiles = { "name": "best-practice2" }
s.paVulnerabilityProtectProfilesDelete(vulnerabilityProtectProfiles, "Remote Networks")
```